2025-11-25 05:31:18 - vaep_pipeline - INFO - ================================================================================
2025-11-25 05:31:18 - vaep_pipeline - INFO - VAEP Pipeline Execution
2025-11-25 05:31:18 - vaep_pipeline - INFO - ================================================================================
2025-11-25 05:31:18 - vaep_pipeline - INFO - Loaded configuration from: ../config.yaml
2025-11-25 05:31:18 - vaep_pipeline - WARNING - 
================================================================================
2025-11-25 05:31:18 - vaep_pipeline - WARNING - DEBUG MODE: Running with limited data and epochs
2025-11-25 05:31:18 - vaep_pipeline - WARNING - ================================================================================

2025-11-25 05:31:18 - vaep_pipeline - INFO - 
================================================================================
2025-11-25 05:31:18 - vaep_pipeline - INFO - Step: Data Preprocessing
2025-11-25 05:31:18 - vaep_pipeline - INFO - Command: /root/ais_venv/bin/python /root/AIS/scripts/preprocess_wyscout.py --debug
2025-11-25 05:31:18 - vaep_pipeline - INFO - ================================================================================

2025-11-25 05:31:18 - preprocess_wyscout - INFO - ================================================================================
2025-11-25 05:31:18 - preprocess_wyscout - INFO - Starting Wyscout data preprocessing for VAEP
2025-11-25 05:31:18 - preprocess_wyscout - INFO - ================================================================================
2025-11-25 05:31:18 - preprocess_wyscout - INFO - Data directory: /root/AIS/data/wyscout
2025-11-25 05:31:18 - preprocess_wyscout - INFO - Output directory: /root/AIS/data/processed
2025-11-25 05:31:18 - preprocess_wyscout - INFO - 
Loading match information...
2025-11-25 05:31:18 - preprocess_wyscout - INFO - Loaded 380 matches from England
2025-11-25 05:31:19 - preprocess_wyscout - INFO - Loaded 380 matches from Spain
2025-11-25 05:31:19 - preprocess_wyscout - INFO - Loaded 380 matches from France
2025-11-25 05:31:19 - preprocess_wyscout - INFO - Loaded 306 matches from Germany
2025-11-25 05:31:19 - preprocess_wyscout - INFO - Loaded 380 matches from Italy
2025-11-25 05:31:19 - preprocess_wyscout - INFO - Loaded 51 matches from European_Championship
2025-11-25 05:31:19 - preprocess_wyscout - INFO - Loaded 64 matches from World_Cup
2025-11-25 05:31:19 - preprocess_wyscout - INFO - Total matches loaded: 1941
2025-11-25 05:31:19 - preprocess_wyscout - WARNING - 
================================================================================
2025-11-25 05:31:19 - preprocess_wyscout - WARNING - DEBUG MODE ENABLED: Processing only 5 matches per league
2025-11-25 05:31:19 - preprocess_wyscout - WARNING - ================================================================================

2025-11-25 05:31:19 - preprocess_wyscout - INFO - 
================================================================================
2025-11-25 05:31:19 - preprocess_wyscout - INFO - Processing events from each league
2025-11-25 05:31:19 - preprocess_wyscout - INFO - ================================================================================
Processing leagues:   0%|          | 0/7 [00:00<?, ?league/s]2025-11-25 05:31:19 - preprocess_wyscout - INFO - 
========================================
2025-11-25 05:31:19 - preprocess_wyscout - INFO - Processing: England
2025-11-25 05:31:19 - preprocess_wyscout - INFO - ========================================
2025-11-25 05:31:25 - preprocess_wyscout - INFO - [DEBUG MODE] Limited to 5 matches
2025-11-25 05:31:25 - preprocess_wyscout - INFO - Processing 8101 events from England
2025-11-25 05:31:25 - preprocess_wyscout - INFO - Extracting position features...
2025-11-25 05:31:25 - preprocess_wyscout - INFO - Extracting tags...
2025-11-25 05:31:25 - preprocess_wyscout - INFO - Computing movement features...

Distance:   0%|          | 0/8101 [00:00<?, ?it/s][A
Distance:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 6480/8101 [00:00<00:00, 64791.87it/s][A
                                                                [A
Angle:   0%|          | 0/8101 [00:00<?, ?it/s][A
Angle:  81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 6559/8101 [00:00<00:00, 65586.78it/s][A
                                                             [A2025-11-25 05:31:26 - preprocess_wyscout - INFO - Computing goal-related features...

Goal distance:   0%|          | 0/8101 [00:00<?, ?it/s][A
                                                       [A
Goal angle:   0%|          | 0/8101 [00:00<?, ?it/s][A
                                                    [A2025-11-25 05:31:26 - preprocess_wyscout - INFO - Processing time information...
2025-11-25 05:31:26 - preprocess_wyscout - INFO - Processed 8101 events
2025-11-25 05:31:26 - preprocess_wyscout - INFO - Set 8101 events for evaluation (England)
Processing leagues:  14%|â–ˆâ–        | 1/7 [00:07<00:43,  7.26s/league]2025-11-25 05:31:26 - preprocess_wyscout - INFO - 
========================================
2025-11-25 05:31:26 - preprocess_wyscout - INFO - Processing: Spain
2025-11-25 05:31:26 - preprocess_wyscout - INFO - ========================================
2025-11-25 05:31:35 - preprocess_wyscout - INFO - [DEBUG MODE] Limited to 5 matches
2025-11-25 05:31:35 - preprocess_wyscout - INFO - Processing 7797 events from Spain
2025-11-25 05:31:35 - preprocess_wyscout - INFO - Extracting position features...
2025-11-25 05:31:35 - preprocess_wyscout - INFO - Extracting tags...
2025-11-25 05:31:35 - preprocess_wyscout - INFO - Computing movement features...

Distance:   0%|          | 0/7797 [00:00<?, ?it/s][A
Distance:  84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 6578/7797 [00:00<00:00, 65778.18it/s][A
                                                                [A
Angle:   0%|          | 0/7797 [00:00<?, ?it/s][A
Angle:  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 6836/7797 [00:00<00:00, 68356.48it/s][A
                                                             [A2025-11-25 05:31:35 - preprocess_wyscout - INFO - Computing goal-related features...

Goal distance:   0%|          | 0/7797 [00:00<?, ?it/s][A
                                                       [A
Goal angle:   0%|          | 0/7797 [00:00<?, ?it/s][A
                                                    [A2025-11-25 05:31:35 - preprocess_wyscout - INFO - Processing time information...
2025-11-25 05:31:35 - preprocess_wyscout - INFO - Processed 7797 events
2025-11-25 05:31:36 - preprocess_wyscout - INFO - Added 7797 events to training set
Processing leagues:  29%|â–ˆâ–ˆâ–Š       | 2/7 [00:16<00:43,  8.64s/league]2025-11-25 05:31:36 - preprocess_wyscout - INFO - 
========================================
2025-11-25 05:31:36 - preprocess_wyscout - INFO - Processing: France
2025-11-25 05:31:36 - preprocess_wyscout - INFO - ========================================
2025-11-25 05:31:45 - preprocess_wyscout - INFO - [DEBUG MODE] Limited to 5 matches
2025-11-25 05:31:45 - preprocess_wyscout - INFO - Processing 8038 events from France
2025-11-25 05:31:45 - preprocess_wyscout - INFO - Extracting position features...
2025-11-25 05:31:45 - preprocess_wyscout - INFO - Extracting tags...
2025-11-25 05:31:45 - preprocess_wyscout - INFO - Computing movement features...

Distance:   0%|          | 0/8038 [00:00<?, ?it/s][A
Distance:  84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 6731/8038 [00:00<00:00, 67305.09it/s][A
                                                                [A
Angle:   0%|          | 0/8038 [00:00<?, ?it/s][A
Angle:  86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 6885/8038 [00:00<00:00, 68843.66it/s][A
                                                             [A2025-11-25 05:31:45 - preprocess_wyscout - INFO - Computing goal-related features...

Goal distance:   0%|          | 0/8038 [00:00<?, ?it/s][A
                                                       [A
Goal angle:   0%|          | 0/8038 [00:00<?, ?it/s][A
                                                    [A2025-11-25 05:31:46 - preprocess_wyscout - INFO - Processing time information...
2025-11-25 05:31:46 - preprocess_wyscout - INFO - Processed 8038 events
2025-11-25 05:31:46 - preprocess_wyscout - INFO - Added 8038 events to training set
Processing leagues:  43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 3/7 [00:26<00:37,  9.27s/league]2025-11-25 05:31:46 - preprocess_wyscout - INFO - 
========================================
2025-11-25 05:31:46 - preprocess_wyscout - INFO - Processing: Germany
2025-11-25 05:31:46 - preprocess_wyscout - INFO - ========================================
2025-11-25 05:31:54 - preprocess_wyscout - INFO - [DEBUG MODE] Limited to 5 matches
2025-11-25 05:31:54 - preprocess_wyscout - INFO - Processing 8344 events from Germany
2025-11-25 05:31:54 - preprocess_wyscout - INFO - Extracting position features...
2025-11-25 05:31:54 - preprocess_wyscout - INFO - Extracting tags...
2025-11-25 05:31:54 - preprocess_wyscout - INFO - Computing movement features...

Distance:   0%|          | 0/8344 [00:00<?, ?it/s][A
Distance:  79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 6599/8344 [00:00<00:00, 65981.57it/s][A
                                                                [A
Angle:   0%|          | 0/8344 [00:00<?, ?it/s][A
Angle:  82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 6838/8344 [00:00<00:00, 68371.10it/s][A
                                                             [A2025-11-25 05:31:54 - preprocess_wyscout - INFO - Computing goal-related features...

Goal distance:   0%|          | 0/8344 [00:00<?, ?it/s][A
                                                       [A
Goal angle:   0%|          | 0/8344 [00:00<?, ?it/s][A
                                                    [A2025-11-25 05:31:55 - preprocess_wyscout - INFO - Processing time information...
2025-11-25 05:31:55 - preprocess_wyscout - INFO - Processed 8344 events
2025-11-25 05:31:55 - preprocess_wyscout - INFO - Added 8344 events to training set
Processing leagues:  57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 4/7 [00:36<00:27,  9.22s/league]2025-11-25 05:31:55 - preprocess_wyscout - INFO - 
========================================
2025-11-25 05:31:55 - preprocess_wyscout - INFO - Processing: Italy
2025-11-25 05:31:55 - preprocess_wyscout - INFO - ========================================
2025-11-25 05:32:06 - preprocess_wyscout - INFO - [DEBUG MODE] Limited to 5 matches
2025-11-25 05:32:06 - preprocess_wyscout - INFO - Processing 8010 events from Italy
2025-11-25 05:32:06 - preprocess_wyscout - INFO - Extracting position features...
2025-11-25 05:32:06 - preprocess_wyscout - INFO - Extracting tags...
2025-11-25 05:32:06 - preprocess_wyscout - INFO - Computing movement features...

Distance:   0%|          | 0/8010 [00:00<?, ?it/s][A
Distance:  84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 6737/8010 [00:00<00:00, 67361.23it/s][A
                                                                [A
Angle:   0%|          | 0/8010 [00:00<?, ?it/s][A
Angle:  85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 6806/8010 [00:00<00:00, 68058.93it/s][A
                                                             [A2025-11-25 05:32:06 - preprocess_wyscout - INFO - Computing goal-related features...

Goal distance:   0%|          | 0/8010 [00:00<?, ?it/s][A
                                                       [A
Goal angle:   0%|          | 0/8010 [00:00<?, ?it/s][A
                                                    [A2025-11-25 05:32:07 - preprocess_wyscout - INFO - Processing time information...
2025-11-25 05:32:07 - preprocess_wyscout - INFO - Processed 8010 events
2025-11-25 05:32:07 - preprocess_wyscout - INFO - Added 8010 events to training set
Processing leagues:  71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 5/7 [00:47<00:20, 10.18s/league]2025-11-25 05:32:07 - preprocess_wyscout - INFO - 
========================================
2025-11-25 05:32:07 - preprocess_wyscout - INFO - Processing: European_Championship
2025-11-25 05:32:07 - preprocess_wyscout - INFO - ========================================
2025-11-25 05:32:08 - preprocess_wyscout - INFO - [DEBUG MODE] Limited to 5 matches
2025-11-25 05:32:08 - preprocess_wyscout - INFO - Processing 7769 events from European_Championship
2025-11-25 05:32:08 - preprocess_wyscout - INFO - Extracting position features...
2025-11-25 05:32:08 - preprocess_wyscout - INFO - Extracting tags...
2025-11-25 05:32:08 - preprocess_wyscout - INFO - Computing movement features...

Distance:   0%|          | 0/7769 [00:00<?, ?it/s][A
Distance:  86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 6667/7769 [00:00<00:00, 66666.41it/s][A
                                                                [A
Angle:   0%|          | 0/7769 [00:00<?, ?it/s][A
Angle:  86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 6696/7769 [00:00<00:00, 66954.16it/s][A
                                                             [A2025-11-25 05:32:08 - preprocess_wyscout - INFO - Computing goal-related features...

Goal distance:   0%|          | 0/7769 [00:00<?, ?it/s][A
                                                       [A
Goal angle:   0%|          | 0/7769 [00:00<?, ?it/s][A
                                                    [A2025-11-25 05:32:08 - preprocess_wyscout - INFO - Processing time information...
2025-11-25 05:32:08 - preprocess_wyscout - INFO - Processed 7769 events
2025-11-25 05:32:08 - preprocess_wyscout - INFO - Added 7769 events to training set
Processing leagues:  86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 6/7 [00:49<00:07,  7.36s/league]2025-11-25 05:32:08 - preprocess_wyscout - INFO - 
========================================
2025-11-25 05:32:08 - preprocess_wyscout - INFO - Processing: World_Cup
2025-11-25 05:32:08 - preprocess_wyscout - INFO - ========================================
2025-11-25 05:32:09 - preprocess_wyscout - INFO - [DEBUG MODE] Limited to 5 matches
2025-11-25 05:32:09 - preprocess_wyscout - INFO - Processing 8006 events from World_Cup
2025-11-25 05:32:09 - preprocess_wyscout - INFO - Extracting position features...
2025-11-25 05:32:09 - preprocess_wyscout - INFO - Extracting tags...
2025-11-25 05:32:09 - preprocess_wyscout - INFO - Computing movement features...

Distance:   0%|          | 0/8006 [00:00<?, ?it/s][A
Distance:  85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 6825/8006 [00:00<00:00, 68242.58it/s][A
                                                                [A
Angle:   0%|          | 0/8006 [00:00<?, ?it/s][A
Angle:  81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 6454/8006 [00:00<00:00, 64538.83it/s][A
                                                             [A2025-11-25 05:32:10 - preprocess_wyscout - INFO - Computing goal-related features...

Goal distance:   0%|          | 0/8006 [00:00<?, ?it/s][A
                                                       [A
Goal angle:   0%|          | 0/8006 [00:00<?, ?it/s][A
                                                    [A2025-11-25 05:32:10 - preprocess_wyscout - INFO - Processing time information...
2025-11-25 05:32:10 - preprocess_wyscout - INFO - Processed 8006 events
2025-11-25 05:32:10 - preprocess_wyscout - INFO - Added 8006 events to training set
Processing leagues: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 7/7 [00:51<00:00,  5.43s/league]Processing leagues: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 7/7 [00:51<00:00,  7.32s/league]
2025-11-25 05:32:10 - preprocess_wyscout - INFO - 
================================================================================
2025-11-25 05:32:10 - preprocess_wyscout - INFO - Merging training data (excluding England)
2025-11-25 05:32:10 - preprocess_wyscout - INFO - ================================================================================
2025-11-25 05:32:10 - preprocess_wyscout - INFO - Total training events: 47964
2025-11-25 05:32:11 - preprocess_wyscout - INFO - Saved training data to: /root/AIS/data/processed/vaep_train_events.csv
2025-11-25 05:32:11 - preprocess_wyscout - INFO -   - Total events: 47964
2025-11-25 05:32:11 - preprocess_wyscout - INFO -   - Unique matches: 30
2025-11-25 05:32:11 - preprocess_wyscout - INFO -   - Unique players: 673
2025-11-25 05:32:11 - preprocess_wyscout - INFO -   - Leagues: ['European_Championship', 'World_Cup', 'France', 'Germany', 'Spain', 'Italy']
2025-11-25 05:32:11 - preprocess_wyscout - INFO - 
================================================================================
2025-11-25 05:32:11 - preprocess_wyscout - INFO - Saving evaluation data (England)
2025-11-25 05:32:11 - preprocess_wyscout - INFO - ================================================================================
2025-11-25 05:32:11 - preprocess_wyscout - INFO - Saved evaluation data to: /root/AIS/data/processed/vaep_eval_events_england.csv
2025-11-25 05:32:11 - preprocess_wyscout - INFO -   - Total events: 8101
2025-11-25 05:32:11 - preprocess_wyscout - INFO -   - Unique matches: 5
2025-11-25 05:32:11 - preprocess_wyscout - INFO -   - Unique players: 137
2025-11-25 05:32:11 - preprocess_wyscout - INFO - 
================================================================================
2025-11-25 05:32:11 - preprocess_wyscout - INFO - Preprocessing completed successfully!
2025-11-25 05:32:11 - preprocess_wyscout - INFO - ================================================================================
2025-11-25 05:32:11 - vaep_pipeline - INFO - 
âœ“ Data Preprocessing completed successfully!
2025-11-25 05:32:11 - vaep_pipeline - INFO - 
================================================================================
2025-11-25 05:32:11 - vaep_pipeline - INFO - Step: Model Training
2025-11-25 05:32:11 - vaep_pipeline - INFO - Command: /root/ais_venv/bin/python /root/AIS/scripts/train_vaep_model.py --config ../config.yaml --debug
2025-11-25 05:32:11 - vaep_pipeline - INFO - ================================================================================

2025-11-25 05:32:13 - train_vaep - INFO - ================================================================================
2025-11-25 05:32:13 - train_vaep - INFO - VAEP Model Training
2025-11-25 05:32:13 - train_vaep - INFO - ================================================================================
2025-11-25 05:32:13 - train_vaep - INFO - Using device: cuda
2025-11-25 05:32:13 - train_vaep - INFO - Input: /root/AIS/data/processed/vaep_train_events.csv
2025-11-25 05:32:13 - train_vaep - INFO - Output directory: /root/AIS/data/models
2025-11-25 05:32:13 - train_vaep - INFO - Horizon: 10 events
2025-11-25 05:32:13 - train_vaep - INFO - Hidden dimensions: [128, 64]
2025-11-25 05:32:13 - train_vaep - INFO - Batch size: 512
2025-11-25 05:32:13 - train_vaep - INFO - Epochs: 3
2025-11-25 05:32:13 - train_vaep - INFO - Learning rate: 0.001
2025-11-25 05:32:13 - train_vaep - INFO - 
================================================================================
2025-11-25 05:32:13 - train_vaep - INFO - Loading data...
2025-11-25 05:32:13 - train_vaep - INFO - ================================================================================
2025-11-25 05:32:13 - train_vaep - INFO - Loaded 47964 events
2025-11-25 05:32:13 - train_vaep - INFO -   - Unique matches: 30
2025-11-25 05:32:13 - train_vaep - INFO -   - Unique players: 673
2025-11-25 05:32:13 - train_vaep - INFO -   - Leagues: ['European_Championship', 'World_Cup', 'France', 'Germany', 'Spain', 'Italy']
2025-11-25 05:32:13 - train_vaep - INFO - 
================================================================================
2025-11-25 05:32:13 - train_vaep - INFO - Creating features...
2025-11-25 05:32:13 - train_vaep - INFO - ================================================================================
2025-11-25 05:32:13 - train_vaep - INFO - Creating state features...
2025-11-25 05:32:13 - train_vaep - INFO -   - Event types: 10 features
2025-11-25 05:32:13 - train_vaep - INFO -   - Sub-event types: 29 features
2025-11-25 05:32:13 - train_vaep - INFO -   - Tag features: 55 features
2025-11-25 05:32:13 - train_vaep - INFO -   - Position features: 4 features
2025-11-25 05:32:13 - train_vaep - INFO -   - Goal features: 2 features
2025-11-25 05:32:13 - train_vaep - INFO -   - Movement features: 2 features
2025-11-25 05:32:13 - train_vaep - INFO -   - Success features: 1 feature
2025-11-25 05:32:13 - train_vaep - INFO -   - Period features: 2 features
2025-11-25 05:32:13 - train_vaep - INFO - Total feature dimension: 105
2025-11-25 05:32:13 - train_vaep - INFO - 
================================================================================
2025-11-25 05:32:13 - train_vaep - INFO - Creating labels...
2025-11-25 05:32:13 - train_vaep - INFO - ================================================================================
2025-11-25 05:32:13 - train_vaep - INFO - Creating labels with horizon=10 events...
2025-11-25 05:32:46 - train_vaep - INFO -   - Scoring events: 695 (1.45%)
2025-11-25 05:32:46 - train_vaep - INFO -   - Conceding events: 738 (1.54%)
2025-11-25 05:32:46 - train_vaep - INFO - 
================================================================================
2025-11-25 05:32:46 - train_vaep - INFO - Splitting data...
2025-11-25 05:32:46 - train_vaep - INFO - ================================================================================
2025-11-25 05:32:46 - train_vaep - INFO - Training samples: 38619
2025-11-25 05:32:46 - train_vaep - INFO - Validation samples: 9345
2025-11-25 05:32:46 - train_vaep - INFO - 
================================================================================
2025-11-25 05:32:46 - train_vaep - INFO - Creating model...
2025-11-25 05:32:46 - train_vaep - INFO - ================================================================================
2025-11-25 05:32:46 - train_vaep - INFO - Model architecture:
2025-11-25 05:32:46 - train_vaep - INFO -   - Input dimension: 105
2025-11-25 05:32:46 - train_vaep - INFO -   - Hidden dimensions: [128, 64]
2025-11-25 05:32:46 - train_vaep - INFO -   - Total parameters: 21954
2025-11-25 05:32:47 - train_vaep - INFO - 
================================================================================
2025-11-25 05:32:47 - train_vaep - INFO - Training...
2025-11-25 05:32:47 - train_vaep - INFO - ================================================================================
2025-11-25 05:32:47 - train_vaep - INFO - Epoch [1/3] Train Loss: 0.4634 (Score Acc: 0.9318, Concede Acc: 0.9822) | Val Loss: 0.1758 (Score Acc: 0.9825, Concede Acc: 0.9821)
2025-11-25 05:32:47 - train_vaep - INFO -   -> Best model saved (val_loss: 0.1758)
2025-11-25 05:32:48 - train_vaep - INFO - Epoch [2/3] Train Loss: 0.1542 (Score Acc: 0.9863, Concede Acc: 0.9852) | Val Loss: 0.1689 (Score Acc: 0.9825, Concede Acc: 0.9821)
2025-11-25 05:32:48 - train_vaep - INFO -   -> Best model saved (val_loss: 0.1689)
2025-11-25 05:32:48 - train_vaep - INFO - Epoch [3/3] Train Loss: 0.1489 (Score Acc: 0.9863, Concede Acc: 0.9852) | Val Loss: 0.1670 (Score Acc: 0.9825, Concede Acc: 0.9821)
2025-11-25 05:32:48 - train_vaep - INFO -   -> Best model saved (val_loss: 0.1670)
2025-11-25 05:32:48 - train_vaep - INFO - 
================================================================================
2025-11-25 05:32:48 - train_vaep - INFO - Saving configuration...
2025-11-25 05:32:48 - train_vaep - INFO - ================================================================================
2025-11-25 05:32:48 - train_vaep - INFO - Configuration saved to: /root/AIS/data/models/vaep_config.json
2025-11-25 05:32:48 - train_vaep - INFO - 
================================================================================
2025-11-25 05:32:48 - train_vaep - INFO - Training completed successfully!
2025-11-25 05:32:48 - train_vaep - INFO - ================================================================================
2025-11-25 05:32:48 - train_vaep - INFO - Best validation loss: 0.1670
2025-11-25 05:32:49 - vaep_pipeline - INFO - 
âœ“ Model Training completed successfully!
2025-11-25 05:32:49 - vaep_pipeline - INFO - 
================================================================================
2025-11-25 05:32:49 - vaep_pipeline - INFO - Step: Player VAEP Computation
2025-11-25 05:32:49 - vaep_pipeline - INFO - Command: /root/ais_venv/bin/python /root/AIS/scripts/compute_player_vaep.py
2025-11-25 05:32:49 - vaep_pipeline - INFO - ================================================================================

2025-11-25 05:32:51 - compute_player_vaep - INFO - ================================================================================
2025-11-25 05:32:51 - compute_player_vaep - INFO - Computing Player VAEP
2025-11-25 05:32:51 - compute_player_vaep - INFO - ================================================================================
2025-11-25 05:32:51 - compute_player_vaep - INFO - Using device: cuda
2025-11-25 05:32:51 - compute_player_vaep - INFO - Input: /root/AIS/data/processed/vaep_eval_events_england.csv
2025-11-25 05:32:51 - compute_player_vaep - INFO - Model: /root/AIS/data/models/vaep_model.pt
2025-11-25 05:32:51 - compute_player_vaep - INFO - Config: /root/AIS/data/models/vaep_config.json
2025-11-25 05:32:51 - compute_player_vaep - INFO - Matches: /root/AIS/data/wyscout/matches_England.json
2025-11-25 05:32:51 - compute_player_vaep - INFO - Output directory: /root/AIS/data/vaep_results
2025-11-25 05:32:51 - compute_player_vaep - INFO - 
================================================================================
2025-11-25 05:32:51 - compute_player_vaep - INFO - Loading model...
2025-11-25 05:32:51 - compute_player_vaep - INFO - ================================================================================
2025-11-25 05:32:51 - compute_player_vaep - INFO - Loading model configuration...
2025-11-25 05:32:51 - compute_player_vaep - INFO -   - Input dimension: 105
2025-11-25 05:32:51 - compute_player_vaep - INFO -   - Hidden dimensions: [128, 64]
2025-11-25 05:32:51 - compute_player_vaep - INFO -   - Horizon: 10
2025-11-25 05:32:51 - compute_player_vaep - INFO - Loading model weights...
2025-11-25 05:32:51 - compute_player_vaep - INFO - Model loaded successfully
2025-11-25 05:32:51 - compute_player_vaep - INFO - 
================================================================================
2025-11-25 05:32:51 - compute_player_vaep - INFO - Loading evaluation data...
2025-11-25 05:32:51 - compute_player_vaep - INFO - ================================================================================
2025-11-25 05:32:51 - compute_player_vaep - INFO - Loaded 8101 events
2025-11-25 05:32:51 - compute_player_vaep - INFO -   - Unique matches: 5
2025-11-25 05:32:51 - compute_player_vaep - INFO -   - Unique players: 137
2025-11-25 05:32:51 - compute_player_vaep - INFO - 
================================================================================
2025-11-25 05:32:51 - compute_player_vaep - INFO - Loading match information...
2025-11-25 05:32:51 - compute_player_vaep - INFO - ================================================================================
2025-11-25 05:32:51 - compute_player_vaep - INFO - Loaded 380 matches
2025-11-25 05:32:51 - compute_player_vaep - INFO - Extracting player minutes from matches...
2025-11-25 05:32:51 - compute_player_vaep - INFO - Extracted minutes for 13668 player-match records
2025-11-25 05:32:51 - compute_player_vaep - INFO - 
================================================================================
2025-11-25 05:32:51 - compute_player_vaep - INFO - Creating state features...
2025-11-25 05:32:51 - compute_player_vaep - INFO - ================================================================================
2025-11-25 05:32:51 - compute_player_vaep - INFO - Creating state features...
2025-11-25 05:32:51 - compute_player_vaep - INFO -   - Event types: 10 features
2025-11-25 05:32:51 - compute_player_vaep - INFO -   - Sub-event types: 29 features
2025-11-25 05:32:51 - compute_player_vaep - INFO -   - Tag features: 55 features
2025-11-25 05:32:51 - compute_player_vaep - INFO -   - Position features: 4 features
2025-11-25 05:32:51 - compute_player_vaep - INFO -   - Goal features: 2 features
2025-11-25 05:32:51 - compute_player_vaep - INFO -   - Movement features: 2 features
2025-11-25 05:32:51 - compute_player_vaep - INFO -   - Success features: 1 feature
2025-11-25 05:32:51 - compute_player_vaep - INFO -   - Period features: 2 features
2025-11-25 05:32:51 - compute_player_vaep - INFO - Total feature dimension: 105
2025-11-25 05:32:51 - compute_player_vaep - INFO - 
================================================================================
2025-11-25 05:32:51 - compute_player_vaep - INFO - Computing state values...
2025-11-25 05:32:51 - compute_player_vaep - INFO - ================================================================================
2025-11-25 05:32:51 - compute_player_vaep - INFO - Computed state values for 8101 events
2025-11-25 05:32:51 - compute_player_vaep - INFO -   - Mean: -0.000418
2025-11-25 05:32:51 - compute_player_vaep - INFO -   - Std: 0.002772
2025-11-25 05:32:51 - compute_player_vaep - INFO - 
================================================================================
2025-11-25 05:32:51 - compute_player_vaep - INFO - Computing event VAEP...
2025-11-25 05:32:51 - compute_player_vaep - INFO - ================================================================================
2025-11-25 05:32:51 - compute_player_vaep - INFO - Computing VAEP for each event...
2025-11-25 05:32:52 - compute_player_vaep - INFO - VAEP statistics:
2025-11-25 05:32:52 - compute_player_vaep - INFO -   - Mean: 0.000000
2025-11-25 05:32:52 - compute_player_vaep - INFO -   - Std: 0.003834
2025-11-25 05:32:52 - compute_player_vaep - INFO -   - Min: -0.070760
2025-11-25 05:32:52 - compute_player_vaep - INFO -   - Max: 0.077229
2025-11-25 05:32:52 - compute_player_vaep - INFO - 
================================================================================
2025-11-25 05:32:52 - compute_player_vaep - INFO - Computing player-match VAEP...
2025-11-25 05:32:52 - compute_player_vaep - INFO - ================================================================================
2025-11-25 05:32:52 - compute_player_vaep - INFO - Computing player-match VAEP...
2025-11-25 05:32:52 - compute_player_vaep - INFO - Computed VAEP for 146 player-match combinations
2025-11-25 05:32:52 - compute_player_vaep - INFO - Saved player-match VAEP to: /root/AIS/data/vaep_results/player_match_vaep_england.csv
2025-11-25 05:32:52 - compute_player_vaep - INFO - 
================================================================================
2025-11-25 05:32:52 - compute_player_vaep - INFO - Computing player season VAEP...
2025-11-25 05:32:52 - compute_player_vaep - INFO - ================================================================================
2025-11-25 05:32:52 - compute_player_vaep - INFO - Computing player season VAEP...
2025-11-25 05:32:52 - compute_player_vaep - INFO - Computed season VAEP for 137 players
2025-11-25 05:32:52 - compute_player_vaep - INFO - 
Top 5 players by VAEP per 90:
2025-11-25 05:32:52 - compute_player_vaep - INFO -   1. Player 7870: 8.195509 VAEP/90 (1 matches)
2025-11-25 05:32:52 - compute_player_vaep - INFO -   2. Player 26010: 5.812022 VAEP/90 (1 matches)
2025-11-25 05:32:52 - compute_player_vaep - INFO -   3. Player 3324: 5.749058 VAEP/90 (1 matches)
2025-11-25 05:32:52 - compute_player_vaep - INFO -   4. Player 8747: 1.704729 VAEP/90 (1 matches)
2025-11-25 05:32:52 - compute_player_vaep - INFO -   5. Player 8471: 1.084865 VAEP/90 (1 matches)
2025-11-25 05:32:52 - compute_player_vaep - INFO - Saved player season VAEP to: /root/AIS/data/vaep_results/player_season_vaep_england.csv
2025-11-25 05:32:52 - compute_player_vaep - INFO - 
================================================================================
2025-11-25 05:32:52 - compute_player_vaep - INFO - VAEP computation completed successfully!
2025-11-25 05:32:52 - compute_player_vaep - INFO - ================================================================================
2025-11-25 05:32:52 - compute_player_vaep - INFO - 
Output files:
2025-11-25 05:32:52 - compute_player_vaep - INFO -   1. /root/AIS/data/vaep_results/player_match_vaep_england.csv
2025-11-25 05:32:52 - compute_player_vaep - INFO -   2. /root/AIS/data/vaep_results/player_season_vaep_england.csv
2025-11-25 05:32:53 - vaep_pipeline - INFO - 
âœ“ Player VAEP Computation completed successfully!
2025-11-25 05:32:53 - vaep_pipeline - INFO - 
================================================================================
2025-11-25 05:32:53 - vaep_pipeline - INFO - âœ“ VAEP Pipeline completed successfully!
2025-11-25 05:32:53 - vaep_pipeline - INFO - ================================================================================
2025-11-25 05:32:53 - vaep_pipeline - INFO - 
Output files:
2025-11-25 05:32:53 - vaep_pipeline - INFO -   1. Training data: data/processed/vaep_train_events.csv
2025-11-25 05:32:53 - vaep_pipeline - INFO -   2. Evaluation data: data/processed/vaep_eval_events_england.csv
2025-11-25 05:32:53 - vaep_pipeline - INFO -   3. Model: data/models/vaep_model.pt
2025-11-25 05:32:53 - vaep_pipeline - INFO -   4. Config: data/models/vaep_config.json
2025-11-25 05:32:53 - vaep_pipeline - INFO -   5. Player-match VAEP: data/vaep_results/player_match_vaep_england.csv
2025-11-25 05:32:53 - vaep_pipeline - INFO -   6. Player-season VAEP: data/vaep_results/player_season_vaep_england.csv
